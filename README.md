# Python скрипт для расчета объема кавитационной полости в жидкости по dump файлу LAMMPS

- ## Способ расчета

Система разбивается "сеткой", количество ячеек сетки в одном пространственном направлении задается параметром `NUMBER_OF_CELLS_1D`. Для каждой частицы системы определяется число ее ближайших соседей. Две частицы считаются ближайшими соседями, если расстояние между ними меньше `R_NEAREST_NEIGHBOURS`. Если число соседей частицы болшье или равно `NUM_NEIGHBOURS_LIQUID`, то она считается принадлежащей жидкой фазы. Если на росстоянии меньшем `R_SEP` от ячейки сетка есть хотя бы одна частица жидкой фазы, то и ячейка считается принадлежащей жидкости. Далее находится наибольший кластер связанных ячеек, принадлжеащих газовой фазе. Ячейки связаны, если соприкасаются, то есть имеют хотя бы одну общую вершину.

- ## Входные параметры

### В файле __calc_cavity_solution.py__ в  строках 8-13 необходимо указать:

`DUMPFILE_NAME` - имя dump файла. Файл может содержать любое количество timesteps, любое количество полей данных, главное, чтобы присутствовали id, x, y и z.\
`NUMBER_OF_CELLS_1D` - количество ячеек сетки в одном пространстве направлении (всего ячеек будет `NUMBER_OF_CELLS_1D^3`)\
`R_SEP` - максимальное расстояние ячейки от частицы жидкой фазы, при которм  ячейка также считается принадлежащей жидкости\
`R_NEAREST_NEIGHBOURS` - расстояние, на котором частицы считаются ближашими соседями (обычно расстояние до первого минимума радиальной функции распределения)\
`NUM_NEIGHBOURS_LIQUID` - количество ближайших соседей частицы, начиная с котрого она считается принадлежащей жидкой фазе.\
`ENCODING` - кодировка текстовых файлов.

- ## Результаты
Результаты записываются в два файла:\
__result_cells.txt__ - содержит данные о координатах ячеек (x, y, z), их фазе (phase) и принадлжености к кластеру (in_cluster). Если phase=1, то ячейка принадлежит жидкой фазе, если phase=0 - к газовой. Если in_cluster=1, то ячейка входит в наибольшую кавитационную полость, если in_cluster=0 - не входит.\
__result_volumes.txt__ - содержит данные о числе ячеек, принадлежащих наибольшему кластеру, и объеме наибольшей кавитационной полости.\
Фал записан в формате dump файла LAMMPS для того, чтобы было удобнее обрабатывать его в ovito.

- ## Установка и запуск


Для того, чтобы скопировать файлы с github, вводим из командной строки
```
git clone https://github.com/itpuroran/cavsol.git
```
Далее
```
cd cavsol
```
Для работы скрипта требуются библиотеки numpy и networkx. Для их установки создадим и активируем виртуальное окружение
```
python3 -m venv .venv
source .venv/bin/activate
python3 -m pip install numpy
python3 -m install networkx
```

Запуск скрипта выполняется командой
```
python3 calc_cavity_solution.py
```
